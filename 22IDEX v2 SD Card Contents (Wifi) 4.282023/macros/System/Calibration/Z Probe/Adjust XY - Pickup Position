; Homing XYU axis if they are not homed
if !move.axes[1].homed || !move.axes[0].homed || !move.axes[3].homed
  G28 Y
  G28 X
  G28 U

T0                                    ; Select first tool
G90                                   ; Absolute positioning


; Go to probe pickup position
G1 f18000 Y150 X{global.probePickX} U999

M204 P1000 T1000                      ; Lower the accelerations a little
M280 P0 S{global.probePickAngle}     ; Move probe holder to the 'pick/place' position

M291 S3 P"Press ""OK"" to save new X pos (Y jogging only for convenience)" X1 Y1

set global.probePickX = move.axes[0].machinePosition
; Generate pickupposition.g
echo >"essential/autogen/pickupposition.g" "; THIS FILE IS AUTOGENERATED !"
echo >>"essential/autogen/pickupposition.g" "; Please edit contents of '/macros/System/Calibration/Z Probe/Ajust pickup position'"
echo >>"essential/autogen/pickupposition.g" "; Set X probe pickup position"
echo >>"essential/autogen/pickupposition.g" "if exists(global.probePickX)"
echo >>"essential/autogen/pickupposition.g" "  set global.probePickX = "^{global.probePickX}
echo >>"essential/autogen/pickupposition.g" "else"
echo >>"essential/autogen/pickupposition.g" "  global probePickX = "^{global.probePickX}

M204 P5000 T5000 ; Return the accelerations

M98 P"place.g"
